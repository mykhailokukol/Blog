<!DOCTYPE html>
{% load staticfiles %}
<html>
<head>
	<meta charset="utf-8">
	<title>Welcome Page</title>
	{% include 'blocks/links.html' %}
	<link rel="stylesheet" href="{% static 'css/IndexApp/index.css' %}">
</head>
<body>
{% include 'blocks/header.html' %}

	<div class="content">
		{% for post in posts %}
			<div class="post">
				<h3>{{ post.title }}</h3>
				<p>{{ post.text }}</p>
				<!-- TODO: Перечисление лайкнувших пользователей в виде ссылок на их профили -->
				<!-- Если кол-во лайков больше 1, то они перечисляются через запятую -->
				<p>Нравится: {% for user in post.likes.all %}{% if post.likes.all.count > 1 %}{{ user }}, {% else %}{{ user }}{% endif %}{% endfor %}</p>
				<form class="" action="{% url 'like_post' post.pk %}" method="post">
					{% csrf_token %}
					<button type="submit" name="post_id" value="{{ post.id }}">{% if not request.user in post.likes.all %}Нравится{% else %}Не нравится{% endif %}</button>
				</form>
				{% for comment in comments %}
					{% if comment.post == post %}
						<div class="comment">
							<h4>{{ comment.user }}</h4>
							<p>{{ comment.text }}</p>
						</div>
					{% endif %}
				{% endfor %}
				<form class="" action="{% url 'add_comment' post.pk %}" method="post">
					{% csrf_token %}
					{{ AddCommentForm.as_p }}
					<button type="submit" name="post_comment_id" value="{{ post.id }}">Добавить комментарий</button>
				</form>
			</div>
		{% endfor %}
	</div>

{% include 'blocks/footer.html' %}
</body>
</html>
